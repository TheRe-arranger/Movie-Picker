<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon(s) in the root directory -->

    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <p class="movie-chosen">We should watch... </p>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>

		<script>
		$( document ).ready(function() {
		    var movies = [
		    {
		    	movie: 'Do the right thing', 
		    	picker: 'emily'
		    },
		    {
		    	movie: 'Her', 
		    	picker: 'emily'
		    },
		    {
		    	movie: "I'm still here", 
		    	picker: 'emily'
		    },
		    {
		    	movie: 'Electrick Children', 
		    	picker: 'emily'
		    },
		    {
		    	movie: 'Inglorious Basterds', 
		    	picker: 'brian'
		    },
		    {
		    	movie: 'Breathless', 
		    	picker: 'emily'
		    },
		    {
		    	movie: 'Troll 2', 
		    	picker: 'brian'
		    }, 
		    {
		    	movie: 'Fearless', 
		    	picker: 'brian'
		    },
		    {
		    	movie: 'City of God', 
		    	picker: 'brian'
		    },
		    {
		    	movie: 'Ip Man/Ip Man 2', 
		    	picker: 'brian'
		    },
		    {
		    	movie: 'Louis Theroux Documentary', 
		    	picker: 'emily'
		    }
	    ];

		    var watchedMovies = ['Ip Man/Ip Man 2', 'Electrick Children', 'Do the right thing'];
		    
		   	
		   	var weighting = window.prompt('Who should this choice favor?')

		   	var weight = window.prompt('weight? (0-1)')
		   	
		   	var newMoviesArray = [];
		   	if (weighting.toLowerCase() == 'brian'){
		   		for (var i = 0; i < movies.length; i++) {
		   			var decider = Math.random();
		   			if (movies[i].picker == 'brian'){
		   				if (decider < weight){
		   					newMoviesArray.push(movies[i]);
		   				}
		   			} else if (movies[i].picker == 'emily'){
		   				if (decider > weight){
		   					newMoviesArray.push(movies[i]);
		   				}
		   			}
		   		};
		   	} else if(weighting.toLowerCase() == 'emily'){
		   		for (var i = 0; i < movies.length; i++) {
		   			var decider = Math.random();
		   			if (movies[i].picker == 'emily'){
		   				if (decider < weight){
		   					newMoviesArray.push(movies[i]);
		   				}
		   			} else if (movies[i].picker == 'brian'){
		   				if (decider > weight){
		   					newMoviesArray.push(movies[i]);
		   				}
		   			}
		   		};
		   	} else if(weighting.toLowerCase() != 'emily' || weighting.toLowerCase() != 'brian'){
		   		newMoviesArray = movies;
		   	}
		   	console.log(newMoviesArray)
		   	// create simple array
		   	var moviesArray = _.pluck(newMoviesArray, 'movie');
		   	console.log(moviesArray)
		   	var unwatchedMovies = _.difference(moviesArray, watchedMovies);
		   	console.log(unwatchedMovies)
		    var movieArrayLength = unwatchedMovies.length;
		    var picker = Math.random();
		    var choice = Math.floor(movieArrayLength * picker);
		    var chosenMovie = unwatchedMovies[choice];

		    $('.movie-chosen').append('<span>'+chosenMovie+'</span>')
		});
		</script>
    </body>
</html>
